<!-- Generated by Graft | model=bedrock-claude-v4.5-sonnet-us | sig=23099d237544ef21fd708c9ee287d4fb184f25383be4eaf57feeeab1c3ca29d5 | rev=9488421 | 2025-11-04 -->
<div align="center">

<picture>
  <source media="(prefers-color-scheme: dark)" srcset="docs/assets/logo-dark.svg">
  <img src="docs/assets/logo.svg" alt="Graft Logo" width="200">
</picture>

# Graft

**Git-native documentation pipelines powered by Claude**

</div>

## Overview

Graft is an LLM-powered documentation pipeline that generates and maintains Markdown documents from Markdown prompts. Like grafting branches in horticulture or commits in git, Graft takes content from multiple sources and carefully integrates them into a unified whole—preserving semantic intent while intelligently adapting to changes.

Write documentation instructions once, then let Graft automatically regenerate affected documents when dependencies change. It tracks changes through git history, applying only semantic updates when sources change or complete rewrites when instructions change. The result: documentation that stays synchronized with your actual content without manual copying, pasting, or rewriting.

## Key Features

- **Git-native change detection** - Tracks source changes vs. prompt changes separately through git history
- **Intelligent updates** - Applies only semantic changes when sources update; full regeneration only when instructions change
- **Multi-level documentation DAGs** - Generated documents can be inputs to other prompts, creating sophisticated hierarchies
- **DVC pipeline management** - Efficient caching and dependency tracking with auto-generated pipeline configuration
- **Claude Sonnet 4.5** - High-quality documentation generation via AWS Bedrock
- **Docker-based execution** - Consistent environment with no local Python dependencies
- **Flexible AWS authentication** - Supports profiles, SSO, and environment variables

## Quick Start

```bash
# Build Graft
git clone <graft-repo>
cd graft
make build

# Set up your project
cd ../your-project
bin/graft init

# Configure AWS (Graft mounts ~/.aws automatically for profiles/SSO)
# Or optionally use .env for credentials

# Create a prompt
bin/graft new executive-summary strategy

# Edit docs/strategy/executive-summary.prompt.md:
---
deps:
  - docs/strategy/foundations.md
  - docs/analysis/market.md
---

Synthesize foundations and market analysis into an executive summary.
Focus on key insights and actionable recommendations.

# Generate
bin/graft rebuild
```

View your generated document at `docs/strategy/executive-summary.md`.

## How It Works

Graft combines git-based change detection with DVC pipeline management:

1. **Create prompt files** (`.prompt.md`) with frontmatter specifying dependencies
2. **Graft tracks changes** through git history—source changes vs. prompt instruction changes
3. **Claude generates documents** with context-aware directives:
   - **UPDATE** - Sources changed → apply only semantic changes
   - **GENERATE** - No previous draft → create from scratch
   - Full regeneration only when prompt instructions change
4. **DVC manages the DAG** - Generated docs can be inputs to other prompts, creating sophisticated hierarchies

Changes cascade automatically through dependency chains, regenerating only what's affected.

## Core Commands

| Command | Purpose |
|---------|---------|
| `bin/graft init` | Initialize Graft in a project |
| `bin/graft rebuild` | Regenerate all changed documents |
| `bin/graft new <name> [topic]` | Create a new prompt file |
| `bin/graft status` | Show pipeline status |
| `bin/graft uses <file>` | Show which prompts depend on a file |
| `bin/graft diff <stage>` | Inspect packed prompt context |

## Documentation

- **[Getting Started](docs/getting-started.md)** - Installation and first document
- **[Use Cases](docs/use-cases.md)** - Powerful workflows and creative applications
- **[How It Works](docs/how-it-works.md)** - Change detection, actions, and DAGs
- **[Configuration](docs/configuration.md)** - AWS credentials, models, and settings
- **[Command Reference](docs/command-reference.md)** - Complete CLI documentation
- **[Troubleshooting](docs/troubleshooting.md)** - Common issues and solutions

## Examples

### Multi-level Documentation DAG

Generate strategic documents that cascade from company strategy to team plans:

```yaml
# docs/01-explorations/engineering-analysis.prompt.md
---
deps:
  - docs/00-sources/company-strategy-q1.md
---
Analyze how engineering can support company strategy.

# docs/02-frameworks/backend-team-plan.prompt.md
---
deps:
  - docs/01-explorations/engineering-analysis.md
  - docs/00-sources/backend-capacity.md
---
Create quarterly plan for backend team based on engineering priorities.

# docs/03-integration/integrated-roadmap.prompt.md
---
deps:
  - docs/02-frameworks/backend-team-plan.md
  - docs/02-frameworks/frontend-team-plan.md
  - docs/02-frameworks/infrastructure-team-plan.md
---
Synthesize all team plans into integrated roadmap showing dependencies.
```

**Result**: Update company strategy → engineering analysis regenerates → all team plans update → integrated roadmap reflects changes. Update one team's capacity → only that team plan and integrated roadmap regenerate.

### Intelligent Change Detection

```yaml
# docs/api/reference.prompt.md
---
deps:
  - api/openapi.yaml
  - api/examples/authentication.py
---
Generate API documentation combining OpenAPI spec with code examples.
```

**Source change**: Update `openapi.yaml` → Graft applies UPDATE action, modifying only affected endpoints while keeping the rest identical.

**Instruction change**: Modify prompt to emphasize mobile usage → Graft regenerates entire document with new focus while preserving source content.

### Living Changelogs

```yaml
# releases/sprint-42/release-notes.prompt.md
---
deps:
  - releases/sprint-42/pr-summaries.md
  - releases/sprint-42/breaking-changes.md
---
Generate user-facing release notes. Group by feature area. 
Highlight breaking changes. Use plain language.
```

Export PRs at sprint end, add breaking change details manually, run `bin/graft rebuild`. Release notes synthesize everything automatically. Update PR summaries to clarify unclear descriptions → release notes update immediately.

## License

MIT License - see [LICENSE](LICENSE) for details
